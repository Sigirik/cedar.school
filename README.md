# cedar.school

## üöÄ –û–ø–∏—Å–∞–Ω–∏–µ

Cedar.school ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —à–∫–æ–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –Ω–∞ Django.  
–í–∫–ª—é—á–∞–µ—Ç —à–∞–±–ª–æ–Ω–Ω—ã–µ –Ω–µ–¥–µ–ª–∏, —Ä–µ–¥–∞–∫—Ç–æ—Ä —É—Ä–æ–∫–æ–≤, —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –ø—Ä–µ–¥–º–µ—Ç–æ–≤, –∫–ª–∞—Å—Å–æ–≤ –∏ —É—á–∏—Ç–µ–ª–µ–π, –∞ —Ç–∞–∫–∂–µ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

---

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ API

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑–¥–µ–ª—ë–Ω –Ω–∞ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∑–æ–Ω—ã:

### üñ• Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (Django views)
- **URL**: `/schedule/`
- **–§–∞–π–ª –º–∞—Ä—à—Ä—É—Ç–æ–≤**: `web_urls.py`
- **–§–∞–π–ª view**: `web_views.py`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å HTML (—á–µ—Ä–µ–∑ `render()`), —Ñ–æ—Ä–º—ã, —Å–ø–∏—Å–∫–∏

---

### üìò –®–∞–±–ª–æ–Ω–Ω–∞—è –Ω–µ–¥–µ–ª—è
- **URL-–ø—Ä–µ—Ñ–∏–∫—Å**: `/api/template/`
- **–§–∞–π–ª –º–∞—Ä—à—Ä—É—Ç–æ–≤**: `template_api_urls.py`
- **–§–∞–π–ª view**: `template_api_views.py`
- **–û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã**:
  - `GET template-week/active/` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—É—é —à–∞–±–ª–æ–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é
  - `POST template-week/<id>/clone_to_draft/` ‚Äî —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω –≤ —á–µ—Ä–Ω–æ–≤–∏–∫
  - `GET template-week/historical_templates/` ‚Äî —Å–ø–∏—Å–æ–∫ –ø—Ä–æ—à–ª—ã—Ö –≤–µ—Ä—Å–∏–π

---

### ‚úèÔ∏è –ß–µ—Ä–Ω–æ–≤–∏–∫–∏
- **URL-–ø—Ä–µ—Ñ–∏–∫—Å**: `/api/draft/`
- **–§–∞–π–ª –º–∞—Ä—à—Ä—É—Ç–æ–≤**: `draft_api_urls.py`
- **–§–∞–π–ª view**: `draft_api_views.py`
- **–û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã**:
  - `POST template-drafts/` ‚Äî —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —á–µ—Ä–Ω–æ–≤–∏–∫
  - `POST template-drafts/create-from/<id>/` ‚Äî —Å–æ–∑–¥–∞—Ç—å —á–µ—Ä–Ω–æ–≤–∏–∫ –∏–∑ —à–∞–±–ª–æ–Ω–∞
  - `POST template-drafts/create-empty/` ‚Äî —Å–æ–∑–¥–∞—Ç—å –ø—É—Å—Ç–æ–π —á–µ—Ä–Ω–æ–≤–∏–∫
  - `POST template-drafts/<id>/commit/` ‚Äî —É—Ç–≤–µ—Ä–¥–∏—Ç—å —á–µ—Ä–Ω–æ–≤–∏–∫ –∫–∞–∫ –∞–∫—Ç–∏–≤–Ω—ã–π —à–∞–±–ª–æ–Ω

---

### üìö –ö–¢–ü –∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏
- **URL-–ø—Ä–µ—Ñ–∏–∫—Å**: `/api/ktp/`
- **–§–∞–π–ª –º–∞—Ä—à—Ä—É—Ç–æ–≤**: `ktp_api_urls.py`
- **–§–∞–π–ª view**: `ktp_api_views.py`
- **–°—É—â–Ω–æ—Å—Ç–∏**:
  - `ktp-templates/`, `ktp-sections/`, `ktp-entries/`
  - `subjects/`, `grades/`, `teachers/`, `weekly-norms/`
  - `teacher-subjects/`, `teacher-grades/`, `grade-subjects/`, `student-subjects/`
  - `lesson-types/`, `teacher-availabilities/`, `academic-years/`

---

### üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ —Ä–æ–ª–∏

- **–§–∞–π–ª –º–æ–¥–µ–ª–µ–π**: `users/models.py`
- **–û—Å–Ω–æ–≤–Ω—ã–µ —Ä–æ–ª–∏**: `TEACHER`, `STUDENT`, `PARENT`, `DIRECTOR`, `HEAD_TEACHER`, `ADMIN`, `AUDITOR`
- **–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–ª—è "–æ—Ç—á–µ—Å—Ç–≤–æ", –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –∫ –∫–ª–∞—Å—Å—É, –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤, —Ñ–ª–∞–≥ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ (`individual_subjects_enabled` –¥–ª—è —É—á–µ–Ω–∏–∫–æ–≤)
- **–°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ API**: –≤—Å–µ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∏—Ö —Å–≤—è–∑–µ–π –≤ `users/serializers.py`, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤ API

---

## ‚úÖ –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã
- –í—Å–µ API –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã –Ω–∞ DRF (Django REST Framework)
- ViewSet'—ã —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `DefaultRouter`
- –û–¥–Ω–æ namespace = –æ–¥–∏–Ω –º–æ–¥—É–ª—å (web / template / draft / ktp / users)
- –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏, —Å–≤—è–∑–∏ (—É—á–∏—Ç–µ–ª—å-–ø—Ä–µ–¥–º–µ—Ç, —É—á–µ–Ω–∏–∫-–ø—Ä–µ–¥–º–µ—Ç, –∫–ª–∞—Å—Å-–ø—Ä–µ–¥–º–µ—Ç) —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ core, –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ API –∏ –≤ –∞–¥–º–∏–Ω–∫–µ
- –í—Å–µ –º–æ–¥–µ–ª–∏ —Å–Ω–∞–±–∂–µ–Ω—ã —Ä—É—Å—Å–∫–∏–º–∏ –∏–º–µ–Ω–∞–º–∏ (`verbose_name` –∏ `verbose_name_plural`), –¥–ª—è –∞–¥–º–∏–Ω–∫–∏ –∏ API

---

## üõ† –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–∑—ã (seed-—Å–∫—Ä–∏–ø—Ç—ã)

- –í –ø—Ä–æ–µ–∫—Ç–µ –µ—Å—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏—è:
  - —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∏–ø–æ–≤—ã—Ö —É—á–∏—Ç–µ–ª–µ–π, –∫–ª–∞—Å—Å–æ–≤, –ø—Ä–µ–¥–º–µ—Ç–æ–≤
  - –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–≤—è–∑–µ–π –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —É—á–∏—Ç–µ–ª–µ–π
  - –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–æ—Ä–º –∏ —à–∞–±–ª–æ–Ω–Ω–æ–π –Ω–µ–¥–µ–ª–∏ —Å —É—Ä–æ–∫–∞–º–∏
- –°–∫—Ä–∏–ø—Ç—ã –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –∫–∞–∫ management commands –∏–ª–∏ —á–µ—Ä–µ–∑ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã —Å `django.setup()`
- –ü—Ä–∏–º–µ—Ä –∑–∞–ø—É—Å–∫–∞ management-–∫–æ–º–∞–Ω–¥—ã:
  ```sh
  python manage.py fill_template_week

# –ü–µ—Ä–≤—ã–π —Å—Ç–∞—Ä—Ç (dev)
docker compose up --build

- –ë—ç–∫–µ–Ω–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≥–æ–Ω–∏—Ç –º–∏–≥—Ä–∞—Ü–∏–∏.
- –ï—Å–ª–∏ –≤ –ë–î –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö, –æ–Ω –∑–∞–≥—Ä—É–∑–∏—Ç seed/dev_seed.json.
- –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—É—Å–∫–∏ —Å–∏–¥ –Ω–µ –ø–µ—Ä–µ–∑–∞–ª–∏–≤–∞—é—Ç.

–†—É—á–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
docker compose exec backend python manage.py loaddata seed/dev_seed.json
docker compose exec backend python manage.py migrate

–ú–∏–Ω–∏-—à–ø–∞—Ä–≥–∞–ª–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º docker

–ó–∞–ø—É—Å–∫:
docker compose up -d

–õ–æ–≥–∏ –±—ç–∫–∞:
docker compose logs -f web

–û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ Django-–∫–æ–º–∞–Ω–¥—ã (–≤–Ω—É—Ç—Ä–∏ –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞):
docker compose exec web python manage.py migrate
docker compose exec web python manage.py createsuperuser

–ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å (–µ—Å–ª–∏ –ø–æ–º–µ–Ω—è–ª—Å—è requirements.txt):
docker compose up -d --build

–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:
docker compose down

**–ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã —Å Git (–¥–ª—è –¥–≤–æ–∏—Ö)**
–û–±—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞

–ë–∞–∑–æ–≤—ã–µ –≤–µ—Ç–∫–∏:
main (–ø—Ä–æ–¥) ‚Üê staging (—Å–±–æ—Ä–∫–∞) ‚Üê be/test –∏ fe/test (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–≤–æ–∏—Ö PR).

–†–∞–±–æ—á–∏–µ –≤–µ—Ç–∫–∏ –≤—Å–µ–≥–¥–∞ –∏–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π test-–≤–µ—Ç–∫–∏:
BE ‚Üí feature/be/<task> –æ—Ç be/test
FE ‚Üí feature/fe/<task> –æ—Ç fe/test

–ú–∞–ª–µ–Ω—å–∫–∏–µ PR (‚â§300 SLOC), –æ–¥–∏–Ω –ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å–º—ã—Å–ª.

PowerShell-–∫–æ–º–∞–Ω–¥—ã –±–µ–∑ &&.

# **–î–ª—è –±—ç–∫–µ–Ω–¥–∞**
1. –û–±–Ω–æ–≤–∏—Ç—å—Å—è:
git fetch origin
git checkout be/test
git pull
2. –°–æ–∑–¥–∞—Ç—å —Ä–∞–±–æ—á—É—é –≤–µ—Ç–∫—É:
git checkout -b feature/be/<task-key>-short
3. –†–∞–±–æ—Ç–∞—Ç—å ‚Üí –∫–æ–º–º–∏—Ç—ã:
git add -A
git commit -m "be: <–∫—Ä–∞—Ç–∫–æ —á—Ç–æ —Å–¥–µ–ª–∞–ª–∏>"
git push -u origin feature/be/<task-key>-short
4. PR ‚Üí be/test
–°–æ–∑–¥–∞–π PR (GitHub UI –∏–ª–∏ gh pr create --base be/test --head feature/be/<...>).
–í PR ‚Äî —á–µ–∫-–ª–∏—Å—Ç (—Å–º. –Ω–∏–∂–µ —à–∞–±–ª–æ–Ω).
5. –ü–æ—Å–ª–µ –∞–ø–ø—Ä—É–≤–∞/CI –∑–µ–ª—ë–Ω—ã–π ‚Üí Merge –≤ be/test.
6. –ü—Ä–æ–º–æ—É—Ç –≤ staging:
git checkout staging
git pull
git merge be/test
git push origin staging
(–∏–ª–∏ PR be/test ‚Üí staging ‚Äî –µ—Å–ª–∏ –Ω—É–∂–Ω–æ review)
7. –†–µ–ª–∏–∑ (–∫–æ–≥–¥–∞ FE —Ç–æ–∂–µ –≤–ª–∏—Ç –≤ staging –∏ e2e –æ–∫):
PR staging ‚Üí main, –ø–æ—Å–ª–µ –º–µ—Ä–∂–∞ –ø–æ—Å—Ç–∞–≤–∏—Ç—å —Ç–µ–≥ v0.1.0.

# **–î–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞**
1. –û–±–Ω–æ–≤–∏—Ç—å—Å—è:
git fetch origin
git checkout fe/test
git pull
2. –°–æ–∑–¥–∞—Ç—å —Ä–∞–±–æ—á—É—é –≤–µ—Ç–∫—É:
git checkout -b feature/fe/<task-key>-short
3. –†–∞–±–æ—Ç–∞—Ç—å ‚Üí –∫–æ–º–º–∏—Ç—ã:
git add -A
git commit -m "fe: <–∫—Ä–∞—Ç–∫–æ —á—Ç–æ —Å–¥–µ–ª–∞–ª–∏>"
git push -u origin feature/fe/<task-key>-short
4. PR ‚Üí fe/test (—á–µ–∫-–ª–∏—Å—Ç –Ω–∏–∂–µ).
5. –ü–æ—Å–ª–µ –∞–ø–ø—Ä—É–≤–∞/CI –∑–µ–ª—ë–Ω—ã–π ‚Üí Merge –≤ fe/test.
6. –ü—Ä–æ–º–æ—É—Ç –≤ staging (–∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ —Å–æ–±—Ä–∞—Ç—å –≤–º–µ—Å—Ç–µ —Å BE):
git checkout staging
git pull
git merge fe/test
git push origin staging
(–∏–ª–∏ PR fe/test ‚Üí staging)
7. –†–µ–ª–∏–∑: PR staging ‚Üí main (—Å–æ–≤–º–µ—Å—Ç–Ω–æ —Å BE).