# üìÑ Lesson Detail API

## GET `/api/real_schedule/lessons/{id}/`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∫–∞—Ä—Ç–æ—á–∫—É —Ä–µ–∞–ª—å–Ω–æ–≥–æ —É—Ä–æ–∫–∞.

### –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
- `ADMIN`, `HEAD_TEACHER`, `DIRECTOR` ‚Äî –¥–æ—Å—Ç—É–ø –≤—Å–µ–≥–¥–∞ (–≤–∏–¥—è—Ç –≤—Å–µ—Ö —É—á–µ–Ω–∏–∫–æ–≤).
- `TEACHER` ‚Äî –µ—Å–ª–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω –Ω–∞ —É—Ä–æ–∫ (–∏–ª–∏ –≤ `co_teachers`, –µ—Å–ª–∏ –ø–æ–ª–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è).
- `STUDENT` ‚Äî –µ—Å–ª–∏ –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç —ç—Ç–æ–≥–æ —É—Ä–æ–∫–∞ (`StudentSubject` –ø–æ –ø–∞—Ä–µ *(grade, subject)*) –∏–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ (—á–µ—Ä–µ–∑ `LessonStudent`/M2M).
- `PARENT` ‚Äî –µ—Å–ª–∏ —Å–≤—è–∑–∞–Ω —Å —Ä–µ–±—ë–Ω–∫–æ–º (`ParentChild`) –∏ —É —Ä–µ–±—ë–Ω–∫–∞ –µ—Å—Ç—å –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç *(grade, subject)* –∏–ª–∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ —É—Ä–æ–∫.

### –í–∏–¥–∏–º–æ—Å—Ç—å —Å–ø–∏—Å–∫–∞ —É—á–µ–Ω–∏–∫–æ–≤
- `ADMIN/HEAD_TEACHER/DIRECTOR/TEACHER` ‚Äî **–≤—Å–µ** —É—á–µ–Ω–∏–∫–∏.
- `PARENT` ‚Äî **—Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–µ—Ç–∏**.
- `STUDENT` ‚Äî **—Ç–æ–ª—å–∫–æ —Å–µ–±—è**.

---

### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ 200 (MVP)

```json
{
  "id": 437,
  "subject": 5,
  "grade": 17,
  "teacher": 3,
  "date": "2025-09-02",
  "start_time": "09:00:00",
  "duration_minutes": 45,
  "room_name": null,
  "webinar_url": null,
  "topic": "–¢–µ–º–∞ –±—É–¥–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∞ —É—á–∏—Ç–µ–ª–µ–º –≤ –Ω–∞—á–∞–ª–µ —É—Ä–æ–∫–∞.",
  "materials": [],
  "participants": {
    "teachers": [3],
    "students_count": 28
  },
  "homework_summary": "",
  "students": [
    {
      "id": 101,
      "first_name": "–ò–≤–∞–Ω",
      "last_name": "–ü–µ—Ç—Ä–æ–≤",
      "fio": "–ü–µ—Ç—Ä–æ–≤ –ò–≤–∞–Ω",
      "attendance": {
        "status": "late",
        "late_minutes": 7,
        "display": "–æ–ø–æ–∑–¥–∞–Ω–∏–µ 7 –º–∏–Ω"
      },
      "mark": 4.0
    }
  ]
}
```

#### –ü–æ–ª—è –æ—Ç–≤–µ—Ç–∞

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---|---|---|
| `id` | number | ID —É—Ä–æ–∫–∞ |
| `subject` | number | ID –ø—Ä–µ–¥–º–µ—Ç–∞ |
| `grade` | number | ID –∫–ª–∞—Å—Å–∞/–≥—Ä—É–ø–ø—ã |
| `teacher` | number | ID –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —É—á–∏—Ç–µ–ª—è |
| `date` | string (YYYY-MM-DD) | –õ–æ–∫–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ —É—Ä–æ–∫–∞ |
| `start_time` | string (HH:MM:SS) | –õ–æ–∫–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ |
| `duration_minutes` | number | –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É—Ä–æ–∫–∞ –≤ –º–∏–Ω—É—Ç–∞—Ö |
| `room_name` | string \| null | –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ –ø–æ–¥ –æ—Ñ–ª–∞–π–Ω-–∞—É–¥–∏—Ç–æ—Ä–∏–∏ (–Ω–∞ MVP `null`) |
| `webinar_url` | string \| null | –°—Å—ã–ª–∫–∞ –Ω–∞ –æ–Ω–ª–∞–π–Ω-–∫–æ–º–Ω–∞—Ç—É (–µ—Å–ª–∏ –µ—Å—Ç—å `Room`) |
| `topic` | string | –¢–µ–º–∞ —É—Ä–æ–∫–∞ (—Å–º. –ø—Ä–∞–≤–∏–ª–∞ –Ω–∏–∂–µ) |
| `materials` | array | –ó–∞–≥–ª—É—à–∫–∞ –ø–æ–¥ –º–∞—Ç–µ—Ä–∏–∞–ª—ã (–Ω–∞ MVP –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤) |
| `participants.teachers` | number[] | –í—Å–µ —É—á–∏—Ç–µ–ª—è —É—Ä–æ–∫–∞ (–æ—Å–Ω–æ–≤–Ω–æ–π + `co_teachers`, –µ—Å–ª–∏ –µ—Å—Ç—å) |
| `participants.students_count` | number | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–µ–Ω–∏–∫–æ–≤ –ø–æ –ø–æ–¥–ø–∏—Å–∫–µ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç *(grade, subject)* |
| `homework_summary` | string | –ó–∞–≥–ª—É—à–∫–∞ (–Ω–∞ MVP –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞) |
| `students` | array | –°–ø–∏—Å–æ–∫ —É—á–µ–Ω–∏–∫–æ–≤ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –ø—Ä–∞–≤–∞–º–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ (—Å–º. –≤—ã—à–µ) |
| `students[].attendance.status` | "+" \| "-" \| "late" \| null | –°—Ç–∞—Ç—É—Å –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏ |
| `students[].attendance.late_minutes` | number \| null | –ú–∏–Ω—É—Ç—ã –æ–ø–æ–∑–¥–∞–Ω–∏—è (—Ç–æ–ª—å–∫–æ –ø—Ä–∏ `late`) |
| `students[].attendance.display` | string \| null | –ì–æ—Ç–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–ª—è UI: "+", "-", "–æ–ø–æ–∑–¥–∞–Ω–∏–µ N –º–∏–Ω" |
| `students[].mark` | number \| null | –û—Ü–µ–Ω–∫–∞ (–µ—Å–ª–∏ –≤–µ–¥—ë—Ç—Å—è —É—á—ë—Ç–æ–º `LessonStudent`) |

---

### –ü—Ä–∞–≤–∏–ª–∞ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –∫–ª—é—á–µ–≤—ã—Ö –ø–æ–ª–µ–π

- **`topic`**:
  - –µ—Å–ª–∏ –≤ `RealLesson.topic_title` –µ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ ‚Äî –æ—Ç–¥–∞—Ç—å –µ–≥–æ;
  - –∏–Ω–∞—á–µ –¥–ª—è `STUDENT` –∏ `PARENT` ‚Äî –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π —Ñ–æ–ª–±—ç–∫: **¬´–¢–µ–º–∞ –±—É–¥–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∞ —É—á–∏—Ç–µ–ª–µ–º –≤ –Ω–∞—á–∞–ª–µ —É—Ä–æ–∫–∞.¬ª**;
  - –¥–ª—è –ø–µ–¥—Å–æ—Å—Ç–∞–≤–∞/–∞–¥–º–∏–Ω–æ–≤ ‚Äî –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ `""`.

- **`participants.students_count`** ‚Äî —ç—Ç–æ `COUNT(StudentSubject)` –¥–ª—è –ø–∞—Ä—ã *(grade, subject)*.

- **`students[*].attendance` –∏ `students[*].mark`** ‚Äî –±–µ—Ä—É—Ç—Å—è –∏–∑ `LessonStudent` (–µ—Å–ª–∏ –º–æ–¥–µ–ª–∏ –Ω–µ—Ç ‚Äî –±—É–¥—É—Ç `null`).

- **`date` / `start_time`** ‚Äî –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –∏–∑ `start` —Å —É—á—ë—Ç–æ–º –Ω–∞—Å—Ç—Ä–æ–µ–∫ —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞ –ø—Ä–æ–µ–∫—Ç–∞ (`timezone.localtime`).

---

### –û—à–∏–±–∫–∏

- `401 Unauthorized` ‚Äî –±–µ–∑ —Ç–æ–∫–µ–Ω–∞.
- `403 Forbidden` ‚Äî –Ω–µ—Ç –ø—Ä–∞–≤ —Å–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–∞–≤–∏–ª–∞–º –≤—ã—à–µ.
- `404 Not Found` ‚Äî —É—Ä–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω.

---

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ (cURL)

**–£—á–∏—Ç–µ–ª—å —Å–≤–æ–µ–≥–æ —É—Ä–æ–∫–∞** (–≤–∏–¥–∏—Ç –≤—Å–µ—Ö):
```bash
curl -H "Authorization: Bearer $TEACHER_TOKEN"   http://localhost:8000/api/real_schedule/lessons/437/
```

**–£—á–µ–Ω–∏–∫** (–≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–µ–±—è; –µ—Å–ª–∏ —Ç–µ–º–∞ –Ω–µ –∑–∞–¥–∞–Ω–∞ ‚Äî —Ñ–æ–ª–±—ç–∫-—Ç–µ–∫—Å—Ç):
```bash
curl -H "Authorization: Bearer $STUDENT_TOKEN"   http://localhost:8000/api/real_schedule/lessons/437/
```

**–†–æ–¥–∏—Ç–µ–ª—å** (–≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏—Ö –¥–µ—Ç–µ–π):
```bash
curl -H "Authorization: Bearer $PARENT_TOKEN"   http://localhost:8000/api/real_schedule/lessons/437/
```

---

### –ó–∞–º–µ—Ç–∫–∏

- –ò–º—è Django-—Ä–æ—É—Ç–∞: `lesson-detail`  
  (URL –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∞—Ç—å —á–µ—Ä–µ–∑ `reverse("lesson-detail", kwargs={"id": <id>})`).
- –ü–æ–ª–µ `co_teachers` –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –µ—Å–ª–∏ –µ—Å—Ç—å ‚Äî —É—á–∏—Ç–µ–ª—è –ø–æ–ø–∞–¥—É—Ç –≤ `participants.teachers`; –µ—Å–ª–∏ –Ω–µ—Ç ‚Äî –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è.
- –ü–æ–ª–µ `room_name` –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ –ø–æ–¥ –æ—Ñ–ª–∞–π–Ω-–∞—É–¥–∏—Ç–æ—Ä–∏–∏; —Å–µ–π—á–∞—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `null`.
- –ù–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ —Å–ø–∏—Å–æ–∫ —É—á–µ–Ω–∏–∫–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –§–ò–û –∏ —Å—Ç–∞—Ç—É—Å–æ–≤; –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤/–æ—Ü–µ–Ω–æ–∫ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ POST-—ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º–∏ (–≤–Ω–µ –¥–∞–Ω–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞).
