# Cedar.school API ‚Äî Draft (TemplateWeekDraft)

–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º –º–æ–¥—É–ª—è **draft**. –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã —Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (Bearer {{access_token}}).  
–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `access_token` –±–µ—Ä—ë—Ç—Å—è –∏–∑ –ª–æ–≥–∏–Ω–∞ (—Å–º. Core collection).

---

## üìö Draft ‚Äî TemplateWeekDraft

### 1. GET /api/draft/template-drafts/
–í–µ—Ä–Ω—ë—Ç (–∏–ª–∏ —Å–æ–∑–¥–∞—Å—Ç, –µ—Å–ª–∏ –Ω–µ—Ç) —á–µ—Ä–Ω–æ–≤–∏–∫ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.  
**–û—Ç–≤–µ—Ç:** –æ–±—ä–µ–∫—Ç TemplateWeekDraft `{ id, user, base_week, data, change_history, ... }`.  
**–†–æ–ª–∏:** –ª—é–±–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å„Äê67‚Ä†source„Äë„Äê68‚Ä†source„Äë.

---

### 2. POST /api/draft/template-drafts/create-from/
–°–æ–∑–¥–∞—ë—Ç —á–µ—Ä–Ω–æ–≤–∏–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ —à–∞–±–ª–æ–Ω–Ω–æ–π –Ω–µ–¥–µ–ª–∏. –ï—Å–ª–∏ `template_id` –Ω–µ —É–∫–∞–∑–∞–Ω ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω–∞—è –Ω–µ–¥–µ–ª—è.  
–ü—Ä–∏ —ç—Ç–æ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π —á–µ—Ä–Ω–æ–≤–∏–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–¥–∞–ª—è–µ—Ç—Å—è.  
**Body (JSON):**
```json
{ "template_id": 123 }  // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
```  
**–†–æ–ª–∏:** –ª—é–±–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å„Äê67‚Ä†source„Äë„Äê68‚Ä†source„Äë.

---

### 3. POST /api/draft/template-drafts/create-empty/
–°–æ–∑–¥–∞—ë—Ç –ø—É—Å—Ç–æ–π —á–µ—Ä–Ω–æ–≤–∏–∫ (`data.lessons = []`). –£–¥–∞–ª—è–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏–π.  
**–†–æ–ª–∏:** –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏„Äê67‚Ä†source„Äë„Äê68‚Ä†source„Äë.

---

### 4. PATCH /api/draft/template-drafts/update/
–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –Ω–æ–≤–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —á–µ—Ä–Ω–æ–≤–∏–∫–∞. –¢–µ–ª–æ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–ª—é—á `data` —Å `{ "lessons": [...] }`.  
–ü–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `change_history`.  
**–ü—Ä–∏–º–µ—Ä Body:**
```json
{
  "data": {
    "lessons": [
      {
        "subject": 10,
        "grade": 5,
        "teacher": 42,
        "day_of_week": 0,
        "start_time": "09:00",
        "duration_minutes": 45,
        "type": { "key": "lesson", "label": "–£—Ä–æ–∫" }
      }
    ]
  }
}
```  
**–†–æ–ª–∏:** –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏„Äê67‚Ä†source„Äë„Äê68‚Ä†source„Äë.

---

### 5. POST /api/draft/template-drafts/<draft_id>/commit/
–ü—É–±–ª–∏–∫–∞—Ü–∏—è —á–µ—Ä–Ω–æ–≤–∏–∫–∞ –∫–∞–∫ –Ω–æ–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ–π –Ω–µ–¥–µ–ª–∏.  
- –¢–µ–∫—É—â–∞—è –∞–∫—Ç–∏–≤–Ω–∞—è —Å–Ω–∏–º–∞–µ—Ç—Å—è —Å `is_active`.  
- –°–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤–∞—è TemplateWeek –∏ TemplateLesson –∏–∑ `data.lessons`.  
- –ß–µ—Ä–Ω–æ–≤–∏–∫ –æ—á–∏—â–∞–µ—Ç—Å—è (`data.lessons = []`, `change_history = []`).  
**–†–æ–ª–∏:**  
- –í–ª–∞–¥–µ–ª–µ—Ü ‚Äî –º–æ–∂–µ—Ç –∫–æ–º–º–∏—Ç–∏—Ç—å —Å–≤–æ–π —á–µ—Ä–Ω–æ–≤–∏–∫.  
- –ß—É–∂–æ–π —á–µ—Ä–Ω–æ–≤–∏–∫ ‚Äî —Ç–æ–ª—å–∫–æ —Ä–æ–ª–∏ `ADMIN`, `DIRECTOR`, `HEAD_TEACHER`, `AUDITOR`„Äê68‚Ä†source„Äë.

**–û—Ç–≤–µ—Ç:** `{ "detail": "–ß–µ—Ä–Ω–æ–≤–∏–∫ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω", "week_id": <id> }`

---

### 6. GET /api/draft/template-drafts/exists/
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —á–µ—Ä–Ω–æ–≤–∏–∫–∞.  
**–û—Ç–≤–µ—Ç:** `{ "exists": true|false }`  
**–†–æ–ª–∏:** –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏„Äê67‚Ä†source„Äë„Äê68‚Ä†source„Äë.

---

### 7. POST /api/draft/template-drafts/validate/
–í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Ç–µ–∫—É—â–∏–π —á–µ—Ä–Ω–æ–≤–∏–∫: –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∫–æ–ª–ª–∏–∑–∏–∏ (–ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏/—Ä–µ—Å—É—Ä—Å–∞–º).  
**–û—Ç–≤–µ—Ç:** `{ "lessons": [...], "collisions": [...] }`  
**–†–æ–ª–∏:** –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏„Äê67‚Ä†source„Äë„Äê68‚Ä†source„Äë.

---

## ‚öôÔ∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ Postman
1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –ª–æ–≥–∏–Ω –≤ Core ‚Üí –ø–æ–ª—É—á–∏—Ç–µ `access_token`.  
2. –í—ã–±–µ—Ä–∏—Ç–µ Environment —Å —ç—Ç–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π.  
3. –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã Draft –∏—Å–ø–æ–ª—å–∑—É—é—Ç `Authorization: Bearer {{access_token}}`.  
4. –î–ª—è Update/Commit –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ id –ø—Ä–µ–¥–º–µ—Ç–æ–≤, –∫–ª–∞—Å—Å–æ–≤, —É—á–∏—Ç–µ–ª–µ–π, –∞ —Ç–∞–∫–∂–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ LessonType.
